import{c as B,m as E}from"./methods-00fb6781.js";console.clear();const{baseUrl:z,apiPath:G,customerApi:c,Toast:a}=B,{formatNumber:l}=E;let f=[],o=[],q=0;function C(){axios.get(`${c}/products`).then(e=>{f=e.data.products,y(f)}).catch(e=>{console.log(e.message)})}const T=document.querySelector(".productWrap");function y(e){T.innerHTML=e.map(t=>`<li class="productCard">
    <h4 class="productType">新品</h4>
      <img
        src="${t.images}"
        alt="${t.title}"
      />
      <a href="#" class="addCardBtn" data-id="${t.id}">加入購物車</a>
      <h3>${t.title}</h3>
      <del class="originPrice">NT$${l(t.origin_price)}</del>
      <p class="nowPrice">NT$${l(t.price)}</p>
  </li>`).join(" ")}const h=document.querySelector(".productSelect");function M(e){const t=[];f.forEach(s=>{s.category===e&&t.push(s)}),y(t)}h.addEventListener("change",e=>{e.target.value==="全部"?y(f):M(h.value)});function d(){axios.get(`${c}/carts`).then(e=>{o=e.data.carts,q=e.data.finalTotal,A()}).catch(e=>{console.log(e.message)})}const g=document.querySelector(".shoppingCart-table tbody"),w=document.querySelector(".cartTotal"),L=document.querySelector(".shoppingCart-table tfoot");function A(){if(o.length===0){g.innerHTML='<tr><td colspan="5">您的購物車中沒有任何產品喔！</td></tr>',L.classList.add("hidden");return}g.innerHTML=o.map(e=>`<tr data-id="${e.id}">
          <td>
            <div class="cardItem-title">
              <img src="${e.product.images}" alt="" />
              <p>${e.product.title}</p>
            </div>
          </td>
          <td>NT$${l(e.product.price)}</td>
          <td><button type="button" class="minusBtn">-</button>${e.quantity}<button type="button" class="addBtn">+</button></td>
          <td>${l(e.product.price*e.quantity)}</td>
          <td class="discardBtn">
            <a href="#" class="material-icons"> clear </a>
          </td>
        </tr>`).join(" "),w.innerHTML=`NT$${l(q)}`,L.classList.remove("hidden")}function D(e,t){const s=o.find(n=>n.product.id===e),r=s?s.quantity+1:1,i={data:{productId:e,quantity:r}};axios.post(`${c}/carts`,i).then(n=>{a.fire({icon:"success",title:"成功加入購物車！"}),d(),t.classList.remove("disabled")}).catch(n=>{a.fire({icon:"error",title:"加入購物車失敗!"}),t.classList.remove("disabled")})}T.addEventListener("click",e=>{e.preventDefault(),e.target.matches(".addCardBtn")&&(D(e.target.dataset.id,e.target),e.target.classList.add("disabled"))});const u=document.querySelector(".discardAllBtn");u.addEventListener("click",e=>{e.preventDefault(),P()});function P(){u.classList.add("disabled"),Swal.fire({title:"清空購物車",text:"你確定要清空購物車內的所有產品嗎?",icon:"warning",showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then(e=>{e.isConfirmed&&axios.delete(`${c}/carts`).then(t=>{a.fire({icon:"success",title:`${t.data.message}`}),d(),setTimeout(()=>{u.classList.remove("disabled")},1500)}).catch(t=>{a.fire({icon:"error",title:"清空購物車失敗!"}),setTimeout(()=>{u.classList.remove("disabled")},1500)})})}g.addEventListener("click",e=>{e.preventDefault();const t=e.target.closest("tr").dataset.id;if(e.target.matches(".discardBtn a"))e.target.classList.add("disabled"),v(t);else if(e.target.matches(".minusBtn")){e.target.classList.add("disabled");let s=o.find(r=>r.id===t).quantity-1;s<=0?v(t):b(t,s,e.target)}else if(e.target.matches(".addBtn")){e.target.classList.add("disabled");let s=o.find(r=>r.id===t).quantity+1;b(t,s,e.target)}});function v(e){axios.delete(`${c}/carts/${e}`).then(t=>{a.fire({icon:"success",title:"成功從購物車移除該項產品!"}),d()}).catch(t=>{a.fire({icon:"error",title:"從購物車移除產品失敗!"})})}function b(e,t,s){const r={data:{id:e,quantity:t}};axios.patch(`${c}/carts/`,r).then(i=>{a.fire({icon:"success",title:"成功更新購物車內的產品數量!"}),d(),setTimeout(()=>{s.classList.remove("disabled")},1500)}).catch(i=>{a.fire({icon:"error",title:"更新購物車內的產品數量失敗!"}),setTimeout(()=>{s.classList.remove("disabled")},1500)})}function H(){const e=document.querySelector(".orderInfo-btn");let t={data:{user:{name:document.querySelector("#customerName").value.trim(),tel:document.querySelector("#customerPhone").value.trim(),email:document.querySelector("#customerEmail").value.trim(),address:document.querySelector("#customerAddress").value.trim(),payment:document.querySelector("#tradeWay").value}}};if(o.length===0){Swal.fire({title:"想結帳?",text:"可是您的購物車內還沒有任何商品喔！",icon:"question",confirmButtonText:"繼續逛逛"});return}e.classList.add("disabled"),axios.post(`${c}/orders`,t).then(s=>{a.fire({icon:"success",title:"訂單建立成功!"}),p.reset(),d(),setTimeout(()=>{e.classList.remove("disabled")},1500)}).catch(s=>{a.fire({icon:"error",title:"訂單建立失敗!"}),setTimeout(()=>{e.classList.remove("disabled")},1500)})}const $={姓名:{presence:{message:"為必填欄位"}},電話:{presence:{message:"為必填欄位"},length:{minimum:8,message:"號碼需超 8 碼"}},Email:{presence:{message:"為必填欄位"},email:{message:"格式有誤"}},寄送地址:{presence:{message:"為必填欄位"}}},p=document.querySelector(".orderInfo-form"),I=document.querySelectorAll("input[type=text], input[type=tel], input[type=email]"),k=document.querySelectorAll("[data-message]");p.addEventListener("submit",N);function N(e){e.preventDefault();let t=validate(p,$);t?(F(t),Swal.fire({title:"您的訂單尚未送出",text:"請輸入必填欄位！",icon:"error",confirmButtonText:"確認"})):H()}function F(e){k.forEach(t=>{t.textContent="",t.textContent=e[t.dataset.message]})}I.forEach(e=>{e.addEventListener("change",()=>{O(e)})});function O(e){let t=validate(p,$),s=document.querySelector(`[data-message=${e.name}]`);t?s.textContent=t[e.name]:s.textContent=""}function j(){C(),d()}j();document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".recommendation-wall");e.style.cursor="grab";let t={top:0,left:0,x:0,y:0};const s=function(n){e.style.cursor="grabbing",e.style.userSelect="none",t={left:e.scrollLeft,top:e.scrollTop,x:n.clientX,y:n.clientY},document.addEventListener("mousemove",r),document.addEventListener("mouseup",i)},r=function(n){const S=n.clientX-t.x,x=n.clientY-t.y;e.scrollTop=t.top-x,e.scrollLeft=t.left-S},i=function(){e.style.cursor="grab",e.style.removeProperty("user-select"),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",i)};e.addEventListener("mousedown",s)});let U=document.querySelector(".menuToggle"),W=document.querySelectorAll(".topBar-menu a"),m=document.querySelector(".topBar-menu");U.addEventListener("click",X);W.forEach(e=>{e.addEventListener("click",Y)});function X(){m.classList.contains("openMenu")?m.classList.remove("openMenu"):m.classList.add("openMenu")}function Y(){m.classList.remove("openMenu")}
